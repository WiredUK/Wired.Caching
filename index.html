<!DOCTYPE html>
<html lang="en-us">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-67803092-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-67803092-3');
    </script>

    <meta charset="UTF-8">
    <title>Wired.Caching by WiredUK</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Wired.Caching</h1>
      <h2 class="project-tagline">A package to simplify caching in your .Net projects</h2>
      <a href="https://github.com/WiredUK/Wired.Caching" class="btn">View on GitHub</a>
      <a href="https://github.com/WiredUK/Wired.Caching/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/WiredUK/Wired.Caching/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="wiredcaching" class="anchor" href="#wiredcaching" aria-hidden="true"><span class="octicon octicon-link"></span></a>Wired.Caching</h1>

<p>This is a package to simplify caching in your .Net projects. It started as a simple function but has become useful enough for me to drop into a library of it's own. </p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<ol>
<li>
<p>Add a reference to this library (duh!) by either:</p>

<p>a. Downloading this codebase, or, I recommend;</p>

<p>b. Use the <a href="https://www.nuget.org/packages/Wired.Caching">Nuget package</a> by using the Nuget Package Manager in Visual Studio or running this in the package manager console:</p>

<pre><code>Install-Package Wired.Caching
</code></pre>
</li>
<li>
<p>Create an instance of the cache service:</p>

<div class="highlight highlight-source-cs"><pre><span class="pl-c">//This can go anywhere, or preferably be injected</span>
<span class="pl-k">var</span> cacheService = <span class="pl-k">new</span> InMemoryCache();</pre></div>
</li>
<li>
<p>Replace code where you need something cached. For example this:</p>

<div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span> zombies = context.People
    .Where(p =&gt; p.IsWalking &amp;&amp; p.IsDead)
    .ToList();</pre></div>

<p>Would be replaced with something like this:</p>

<div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span> zombies = cacheService.Get(
    <span class="pl-s"><span class="pl-pds">"</span>zombies<span class="pl-pds">"</span></span>,
    () =&gt; context.People
              .Where(p =&gt; p.IsWalking &amp;&amp; p.IsDead)
              .ToList(),
    <span class="pl-c1">600</span>);</pre></div>

<p>Or you can use the slightly shorter lambda syntax:</p>

<div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span> zombies = cacheService.Get(
    <span class="pl-s"><span class="pl-pds">"</span>zombies<span class="pl-pds">"</span></span>,
    context.People
        .Where(p =&gt; p.IsWalking &amp;&amp; p.IsDead)
        .ToList,
    <span class="pl-c1">600</span>);</pre></div>
</li>
</ol>

<h2>
<a id="caveat" class="anchor" href="#caveat" aria-hidden="true"><span class="octicon octicon-link"></span></a>Caveat</h2>

<p>There's always a <a href="http://shouldiblamecaching.com/">catch</a> right? The main thing you need to be concerned about is when caching something that uses deferred execution. A database context is a good example here, hence why my example ends with <code>ToList()</code>. That materialises the query so you are caching the results and not an <code>IQueryable</code> interface. If you forget to do that, you will probably end up with errors telling you that your context has gone away or disconnected.</p>

<h1>
<a id="wiredcachingmvc" class="anchor" href="#wiredcachingmvc" aria-hidden="true"><span class="octicon octicon-link"></span></a>Wired.Caching.Mvc</h1>

<p>So now you want to use caching in your MVC project? Use this package to simplify that even further. Have you ever wanted to cache the entire return from an Action method? Well now you can by adding a simple attribute.</p>

<h2>
<a id="usage-1" class="anchor" href="#usage-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>So here is an example (but very boring) action:</p>

<div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span> ActionResult Index()
{ 
    <span class="pl-k">return</span> View();
}</pre></div>

<p>So how do we make it cached? Just add the <code>WiredCache</code> attribute, like this:</p>

<div class="highlight highlight-source-cs"><pre>[WiredCache(<span class="pl-c1">600</span>)]
<span class="pl-k">public</span> ActionResult Index()
{ 
    <span class="pl-k">return</span> View();
}</pre></div>

<p>And now that action will not be called more than once every 600 seconds. </p>

<p>Can we get a bit more clever? Sure, what happens if your action has parameters and each variation of parameter has a different output that you want to cache? Simple, just use the <code>KeyOn</code> property. Either specify a comma seperated list of parameter names or use <code>*</code> to use them all. So lets say you have an action that has a single parameter that you don't care about, just do this:</p>

<div class="highlight highlight-source-cs"><pre>[WiredCache(<span class="pl-c1">600</span>, KeyOn = <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>)]
<span class="pl-k">public</span> ActionResult GetProduct(<span class="pl-k">int</span> id, <span class="pl-k">string</span> ignoreThisParameter)
{ 
    <span class="pl-k">return</span> View();
}</pre></div>

<p>Now what happens when inside your action method, the output is different depending on the user that is logged in, perhaps your <code>Index</code> action displays the users name and some specific content to them? That's easy too, just use the <code>KeyOnUser</code> property, like this:</p>

<div class="highlight highlight-source-cs"><pre>[WiredCache(<span class="pl-c1">600</span>, KeyOnUser = <span class="pl-c1">true</span>)]
<span class="pl-k">public</span> ActionResult Index()
{ 
    <span class="pl-k">return</span> View();
}</pre></div>

<p>But typing <code>KeyOnUser = true</code> every time is boring right? Wouldn't it be nice if you could set it once somewhere and forget? Easy! Just configure in your <code>web.config</code>. First add in a new config section:</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">configSections</span>&gt;
    &lt;<span class="pl-ent">section</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>wiredCaching<span class="pl-pds">"</span></span> 
             <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>Wired.Caching.Mvc.CachingConfigSection,Wired.Caching.Mvc<span class="pl-pds">"</span></span>/&gt;
&lt;/<span class="pl-ent">configSections</span>&gt;</pre></div>

<p>Then somewhere else in your config, add this:</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">wiredCaching</span> <span class="pl-e">alwaysKeyOnUser</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span> /&gt;</pre></div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/WiredUK/Wired.Caching">Wired.Caching</a> is maintained by <a href="https://github.com/WiredUK">WiredUK</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-67803092-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
